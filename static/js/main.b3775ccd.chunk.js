(this.webpackJsonpmega2=this.webpackJsonpmega2||[]).push([[0],{18:function(e,t,n){e.exports=n(31)},23:function(e,t,n){},29:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(7),u=n.n(c),o=(n(23),n(4)),i=n(1),s="gameParams/changeSize",l="gameParams/changeSuccessCriteria",m=n(8);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g={size:3,successCriteria:3};var d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s:return f({},e,{size:t.payload});case l:return f({},e,{successCriteria:t.payload});default:return e}};var h=Object(i.b)((function(e){return{size:e.gameParams.size,successCriteria:e.gameParams.successCriteria}}),(function(e){return{dispatch:e,changeSize:function(t){return parseInt(t,10)?e(function(e){return{type:s,payload:e}}(t)):null},changeSuccessCriteria:function(t){return parseInt(t,10)?e(function(e){return{type:l,payload:e}}(t)):null}}}))((function(e){var t=Object(r.useState)(e.size),n=Object(o.a)(t,2),c=n[0],u=n[1],i=Object(r.useState)(e.successCriteria),s=Object(o.a)(i,2),l=s[0],m=s[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"input"},a.a.createElement("label",{htmlFor:"size"},"Size of Square"),a.a.createElement("input",{type:"number",name:"size",id:"size",value:c,onChange:function(t){var n=parseInt(t.target.value);""!==t.target.value&&(u(n),e.changeSize(n))},min:3,max:10}),a.a.createElement("label",{htmlFor:"successCriteria"},"Success Criteria"),a.a.createElement("input",{type:"number",name:"successCriteria",id:"successCriteria",value:l,onChange:function(t){t.target.value>c||(m(t.target.value),e.changeSuccessCriteria(t.target.value))},min:3,max:10})))})),b=n(6),v=n.n(b),O=n(9),y="game/changeGameState",w="game/checkGameOver",j=function(e){return{type:y,payload:e}},E="turns/changeTurn",S=function(e){return{type:E,payload:e}},C=n(17),P=n(2),N=[[0,0,0],[0,0,0],[1,1,0]],k=function(e,t,n){return"X"===n?2:"O"===n?1:void 0};function z(e,t,n,r){for(var a=e.row,c=e.column,u=0,o=0;a>=0&&a<t.length&&c>=0&&c<t.length&&t[a][c]&&t[a][c]===n;)o++,a+=r[0],c+=r[1];for(a=e.row-r[0],c=e.column-r[1];a>=0&&a<t.length&&c>=0&&c<t.length&&t[a][c]&&t[a][c]===n;)u++,a-=r[0],c-=r[1];return u+o}function I(e,t,n){for(var r=e.row,a=e.column,c=[[1,0],[0,1],[-1,-1],[-1,1]],u=0;u<c.length;u++){if(z({row:r,column:a},t,t[r][a],c[u])>=n)return document.title="Game Over",!0}return!1}var D=Object(P.c)({gameState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case s:return new Array(t.payload).fill(0).map((function(e,n){return new Array(t.payload).fill(0)}));case y:var n=t.payload,r=n.row,a=n.column,c=n.turn,u=n.successCriteria,o=e.map((function(e,t){return t===r?e.map((function(e,t){return t===a?k(r,a,c):e})):Object(C.a)(e)}));return console.log("game over"),I({row:r,column:a},o,u),o;default:return e}},gameOver:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:var n=t.payload;return I({row:n.row,column:n.column},n.gameState,n.successCriteria);default:return e}}}),x=Object(i.b)((function(e){var t=e.gameParams,n=e.gameState,r=n.gameState,a=n.gameOver,c=e.turns;return{size:t.size,successCriteria:t.successCriteria,gameState:r,gameOver:a,turn:c.turn,turnNumber:c.turnNumber}}),(function(e){return{dispatch:e,changeGameState:function(t){return e(j(t))},checkGameOver:function(t){return e(function(e){return{type:w,payload:e}}(t))},changeTurns:function(t){return e(S(t))}}}))((function(e){var t=Object(r.useState)({}),n=Object(o.a)(t,2),c=(n[0],n[1]),u=function(t,n){return function(){var r=Object(O.a)(v.a.mark((function r(a){var u,o,i;return v.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return!0,u=e.turn,o=e.turnNumber,i=e.successCriteria,e.gameState,r.next=5,window.peer.connectedRTC.send({turnNumber:o,row:t,column:n,turn:u});case 5:c({row:t,column:n}),0===e.gameState[t][n]&&(e.changeGameState({row:t,column:n,turn:u,successCriteria:i}),e.changeTurns({turn:u,turnNumber:o}));case 7:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},i=new Array(e.size).fill(0);return a.a.createElement("div",{className:"game"},i.map((function(t,n){return a.a.createElement("div",{className:"row",key:n+" row"},i.map((function(t,r){return a.a.createElement("div",{className:"element",key:r+" column",onClick:u(n,r)},function(t,n){switch(e.gameState[t][n]){case 2:return"X";case 1:return"O";case 0:default:return""}}(n,r))})))})))}));function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G={turnNumber:0,turn:"X"};var A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:return++e.turnNumber,"X"===t.payload.turn?X({},e,{turnNumber:e.turnNumber++,turn:"O"}):X({},e,{turnNumber:e.turnNumber++,turn:"X"});default:return e}};var F=Object(i.b)((function(e){return{turn:e.turn}}),(function(e){return{changeTurns:function(t){return e(S(t))}}}))((function(e){return a.a.createElement("div",{className:"ticTac"},a.a.createElement("button",{className:"X"===e.turn?"highlight":""},"X"),a.a.createElement("button",{className:"O"===e.turn?"highlight":""},"O"))})),R=(n(29),n(16)),q=(n(30),Object(P.c)({gameParams:d,turns:A,gameState:D})),B=Object(P.d)(q,P.a.apply(void 0,[R.a])),J=window.peer=new window.Peer({key:"lwjd5qra8257b9"});function M(e,t){e.on("data",(function(e){console.log(e);var n=e.row,r=e.column,a=e.turn,c=e.turnNumber;t(j({row:n,column:r,turn:a})),t(S({turn:a,turnNumber:c}))}))}var W=Object(i.b)(null,(function(e){return{dispatch:e,changeTurns:function(t){return e(S())}}}))((function(e){var t=Object(r.useState)(""),n=Object(o.a)(t,2),c=n[0],u=n[1],i=Object(r.useState)(""),s=Object(o.a)(i,2),l=s[0],m=s[1];Object(r.useEffect)((function(){J.on("open",(function(e){u(e)}))}),[]),Object(r.useEffect)((function(){function t(){return(t=Object(O.a)(v.a.mark((function t(){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J.connect(l);case 2:M(window.peer.connectedRTC=t.sent,e.dispatch);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}J.on("connection",(function(t){console.log("connected"),window.peer.connectedRTC=t,t.on("open",(function(n){M(t,e.dispatch)}))})),function(){t.apply(this,arguments)}()}),[l,e.dispatch]);return a.a.createElement("div",null,a.a.createElement("label",{htmlFor:"peerId"},"My peer ID: "),a.a.createElement("span",{type:"text",name:"peerId",id:"peerId",value:c,minLength:15,style:{display:"inline-block"}}," ",c," "),a.a.createElement("label",{htmlFor:"peerId"},"  Connect to peer ID"),a.a.createElement("input",{type:"text",name:"peerId",id:"peerId",value:l,onChange:function(e){m(e.target.value)}}))}));var L=function(){return a.a.createElement(i.a,{store:B},a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement("h1",null,"Mega")),a.a.createElement(h,null),a.a.createElement(W,null),a.a.createElement(F,null),a.a.createElement(x,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(a.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[18,1,2]]]);
//# sourceMappingURL=main.b3775ccd.chunk.js.map